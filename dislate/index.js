(function(p,C,m,t,D,M,l,d,H,k,z,K,N,T){"use strict";const $="https://deeplx.vercel.app/translate";var P={translate:async function(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto",n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;try{if(s)return{source_lang:r,text:e};const a=await(await fetch($,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,source_lang:r,target_lang:n})})).json();if(a.code!==200)throw Error(`Failed to translate text from DeepL: ${a.message}`);return{source_lang:r,text:a.data}}catch(a){throw Error(`Failed to fetch from DeepL: ${a}`)}}},v={translate:async function(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto",n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;try{if(s)return{source_lang:r,text:e};const a="https://translate.googleapis.com/translate_a/single?"+new URLSearchParams({client:"gtx",sl:r,tl:n,dt:"t",dj:"1",source:"input",q:encodeURIComponent(e)}),h=await(await fetch(a)).json();return console.log(h),{source_lang:r,text:h.sentences[0].trans}}catch(a){throw Error(`Failed to fetch from Google Translate: ${a}`)}}},w;const x=m.findByProps("openLazy","hideActionSheet"),O=((w=m.findByProps("ActionSheetRow"))===null||w===void 0?void 0:w.ActionSheetRow)??d.Forms.FormRow,V=m.findByStoreName("MessageStore"),q=m.findByStoreName("ChannelStore"),Y=t.stylesheet.createThemedStyleSheet({iconComponent:{width:24,height:24,tintColor:M.semanticColors.INTERACTIVE_NORMAL}});let y=[];function J(){return D.before("openLazy",x,function(e){let[r,n,s]=e;const a=s?.message;n!=="MessageLongPressActionSheet"||!a||r.then(function(h){const oe=D.after("default",h,function(Te,ce){t.React.useEffect(function(){return function(){oe()}},[]);const b=H.findInReactTree(ce,function(o){var u,g;return(o==null||(g=o[0])===null||g===void 0||(u=g.type)===null||u===void 0?void 0:u.name)==="ButtonRow"});if(!b)return;const ue=Math.max(b.findIndex(function(o){return o.props.message===t.i18n.Messages.MARK_UNREAD}),0),c=V.getMessage(a.channel_id,a.id);if(!c?.content&&!a.content)return;const _=c?.id??a.id,ge=c?.content??a.content,E=y.find(function(o){return Object.keys(o)[0]===_},"cache object"),B=E?"Revert":"Translate",F=B==="Translate"?l.getAssetIDByName("ic_locale_24px"):l.getAssetIDByName("ic_highlight"),he=async function(){try{const u=i.target_lang,g=B==="Translate";var o;switch(i.translator){case 0:console.log("Translating with DeepL: ",c.content),o=await P.translate(c.content,null,u,!g);case 1:console.log("Translating with GTranslate: ",c.content),o=await v.translate(c.content,null,u,!g)}t.FluxDispatcher.dispatch({type:"MESSAGE_UPDATE",message:{...c,content:`${g?o.text:E[_]} ${g?`\`[${u?.toLowerCase()}]\``:""}`,guild_id:q.getChannel(c.channel_id).guild_id},log_edit:!1}),g?y.unshift({[_]:ge}):y=y.filter(function(de){return de!==E},"cached data override")}catch(u){T.showToast("Failed to translate message. Please check Debug Logs for more info.",l.getAssetIDByName("Small")),k.logger.error(u)}finally{return x.hideActionSheet()}};b.splice(ue,0,t.React.createElement(O,{label:`${B} Message`,icon:t.React.createElement(O.Icon,{source:F,IconComponent:function(){return t.React.createElement(t.ReactNative.Image,{resizeMode:"cover",style:Y.iconComponent,source:F})}}),onPress:he}))})})})}var I;(function(e){e[e.BUILT_IN=0]="BUILT_IN",e[e.BUILT_IN_TEXT=1]="BUILT_IN_TEXT",e[e.BUILT_IN_INTEGRATION=2]="BUILT_IN_INTEGRATION",e[e.BOT=3]="BOT",e[e.PLACEHOLDER=4]="PLACEHOLDER"})(I||(I={}));var R;(function(e){e[e.SUB_COMMAND=1]="SUB_COMMAND",e[e.SUB_COMMAND_GROUP=2]="SUB_COMMAND_GROUP",e[e.STRING=3]="STRING",e[e.INTEGER=4]="INTEGER",e[e.BOOLEAN=5]="BOOLEAN",e[e.USER=6]="USER",e[e.CHANNEL=7]="CHANNEL",e[e.ROLE=8]="ROLE",e[e.MENTIONABLE=9]="MENTIONABLE",e[e.NUMBER=10]="NUMBER",e[e.ATTACHMENT=11]="ATTACHMENT"})(R||(R={}));var L;(function(e){e[e.CHAT=1]="CHAT",e[e.USER=2]="USER",e[e.MESSAGE=3]="MESSAGE"})(L||(L={}));const U={arabic:"AR",bulgarian:"BG",czech:"CS",danish:"DA",german:"DE",greek:"EL",english:"EN",spanish:"ES",estonian:"ET",finnish:"FI",french:"FR",hungarian:"HU",indonesian:"ID",italian:"IT",japanese:"JA",korean:"KO",lithuanian:"LT",latvian:"LV",norwegian:"NO",dutch:"NL",polish:"PL",portuguese:"PT",romanian:"RO",russian:"RU",slovak:"SK",slovenian:"SL",swedish:"SV",turkish:"TR",ukrainian:"UK","chinese-simplified":"ZH"},X={Afrikaans:"af",Albanian:"sq",Amharic:"am",Arabic:"ar",Armenian:"hy",Assamese:"as",Aymara:"ay",Azerbaijani:"az",Bambara:"bm",Basque:"eu",Belarusian:"be",Bengali:"bn",Bhojpuri:"bho",Bosnian:"bs",Bulgarian:"bg",Catalan:"ca",Cebuano:"ceb",Chichewa:"ny","Chinese (Simplified)":"zh-CN","Chinese (Traditional)":"zh-TW",Corsican:"co",Croatian:"hr",Czech:"cs",Danish:"da",Dhivehi:"dv",Dogri:"doi",Dutch:"nl",English:"en",Esperanto:"eo",Estonian:"et",Ewe:"ee",Filipino:"tl",Finnish:"fi",French:"fr",Frisian:"fy",Galician:"gl",Georgian:"ka",German:"de",Greek:"el",Guarani:"gn",Gujarati:"gu","Haitian Creole":"ht",Hausa:"ha",Hawaiian:"haw",Hebrew:"iw",Hindi:"hi",Hmong:"hmn",Hungarian:"hu",Icelandic:"is",Igbo:"ig",Ilocano:"ilo",Indonesian:"id",Irish:"ga",Italian:"it",Japanese:"ja",Javanese:"jw",Kannada:"kn",Kazakh:"kk",Khmer:"km",Kinyarwanda:"rw",Konkani:"gom",Korean:"ko",Krio:"kri","Kurdish (Kurmanji)":"ku","Kurdish (Sorani)":"ckb",Kyrgyz:"ky",Lao:"lo",Latin:"la",Latvian:"lv",Lingala:"ln",Lithuanian:"lt",Luganda:"lg",Luxembourgish:"lb",Macedonian:"mk",Maithili:"mai",Malagasy:"mg",Malay:"ms",Malayalam:"ml",Maltese:"mt",Maori:"mi",Marathi:"mr","Meiteilon (Manipuri)":"mni-Mtei",Mizo:"lus",Mongolian:"mn","Myanmar (Burmese)":"my",Nepali:"ne",Norwegian:"no","Odia (Oriya)":"or",Oromo:"om",Pashto:"ps",Persian:"fa",Polish:"pl",Portuguese:"pt",Punjabi:"pa",Quechua:"qu",Romanian:"ro",Russian:"ru",Samoan:"sm",Sanskrit:"sa","Scots Gaelic":"gd",Sepedi:"nso",Serbian:"sr",Sesotho:"st",Shona:"sn",Sindhi:"sd",Sinhala:"si",Slovak:"sk",Slovenian:"sl",Somali:"so",Spanish:"es",Sundanese:"su",Swahili:"sw",Swedish:"sv",Tajik:"tg",Tamil:"ta",Tatar:"tt",Telugu:"te",Thai:"th",Tigrinya:"ti",Tsonga:"ts",Turkish:"tr",Turkmen:"tk",Twi:"ak",Ukrainian:"uk",Urdu:"ur",Uyghur:"ug",Uzbek:"uz",Vietnamese:"vi",Welsh:"cy",Xhosa:"xh",Yiddish:"yi",Yoruba:"yo",Zulu:"zu"},W=m.findByProps("sendBotMessage"),Z=Object.entries(U).map(function(e){let[r,n]=e;return{name:r,displayName:r,value:n}});Object.entries(v).map(function(e){let[r,n]=e;return{name:r,displayName:r,value:n}});function Q(){return z.registerCommand({name:"translate",displayName:"translate",description:"Send a message using Dislate in any language chosen.",displayDescription:"Send a message using Dislate in any language chosen.",applicationId:"-1",type:L.CHAT,inputType:I.BUILT_IN_TEXT,options:[{name:"text",displayName:"text",description:"The text/message for Dislate to translate. Please note some formatting of mentions and emojis may break due to the API.",displayDescription:"The text/message for Dislate to translate. Please note some formatting of mentions and emojis may break due to the API.",type:R.STRING,required:!0},{name:"language",displayName:"language",description:"The language that Dislate will translate the text into. This can be any language from the list.",displayDescription:"The language that Dislate will translate the text into. This can be any language from the list.",type:R.STRING,choices:[...Z],required:!0}],async execute(e,r){const[n,s]=e;try{var a;switch(i.translator){case 0:a=await P.translate(n.value,null,s.value);case 1:a=await v.translate(n.value,null,s.value)}return await new Promise(function(h){return K.showConfirmationAlert({title:"Are you sure you want to send it?",content:React.createElement(d.Codeblock,null,a.text),confirmText:"Yep, send it!",onConfirm:function(){return h({content:a.text})},cancelText:"Nope, don't send it"})})}catch(h){return k.logger.error(h),W.sendBotMessage(r.channel.id,"Failed to translate message. Please check Debug Logs for more info.",l.getAssetIDByName("Small"))}}})}const{FormRow:S}=d.Forms,{ScrollView:G}=t.ReactNative;function ee(){N.useProxy(i);const[e,r]=t.React.useState("");return i.translator==0?t.React.createElement(G,{style:{flex:1}},t.React.createElement(d.Search,{style:{padding:15},placeholder:"Search Language",onChangeText:function(n){r(n)}}),Object.entries(U).filter(function(n){let[s,a]=n;return s.includes(e)}).map(function(n){let[s,a]=n;return t.React.createElement(S,{label:s,trailing:function(){return t.React.createElement(S.Arrow,null)},onPress:function(){i.target_lang!=a&&(i.target_lang=a,T.showToast(`Saved ToLang to ${s}`,l.getAssetIDByName("check")))}})})):t.React.createElement(G,{style:{flex:1}},t.React.createElement(d.Search,{style:{padding:15},placeholder:"Search Language",onChangeText:function(n){r(n)}}),Object.entries(X).filter(function(n){let[s,a]=n;return s.includes(e)}).map(function(n){let[s,a]=n;return t.React.createElement(S,{label:s,trailing:function(){return t.React.createElement(S.Arrow,null)},onPress:function(){i.target_lang!=a&&(i.target_lang=a,T.showToast(`Saved ToLang to ${s}`,l.getAssetIDByName("check")))}})}))}const{FormRow:A}=d.Forms,{ScrollView:te}=t.ReactNative;function ae(){return N.useProxy(i),t.React.createElement(te,{style:{flex:1}},t.React.createElement(A,{label:"DeepL",trailing:function(){return t.React.createElement(A.Arrow,null)},onPress:function(){i.translator!=0&&(i.translator=0,T.showToast("Saved Translator to DeepL",l.getAssetIDByName("check")))}}),t.React.createElement(A,{label:"Google Translate",trailing:function(){return t.React.createElement(A.Arrow,null)},onPress:function(){i.translator!=1&&(i.translator=1,T.showToast("Saved Translator to Google Translate",l.getAssetIDByName("check")))}}))}const{ScrollView:ne,Text:re}=t.ReactNative,{FormRow:f}=d.Forms,ie=t.stylesheet.createThemedStyleSheet({subheaderText:{color:M.semanticColors.HEADER_SECONDARY,textAlign:"center",margin:10,marginBottom:50,letterSpacing:.25,fontFamily:t.constants.Fonts.PRIMARY_BOLD,fontSize:14}});function se(){var e;const r=t.NavigationNative.useNavigation();return N.useProxy(i),t.React.createElement(ne,null,t.React.createElement(f,{label:"Translate to",subLabel:(e=i.target_lang)===null||e===void 0?void 0:e.toLowerCase(),leading:t.React.createElement(f.Icon,{source:l.getAssetIDByName("ic_activity_24px")}),trailing:function(){return t.React.createElement(f.Arrow,null)},onPress:function(){return r.push("VendettaCustomPage",{title:"Translate to",render:ee})}}),t.React.createElement(f,{label:"Translator",subLabel:i.translator?"Google Translate":"DeepL",leading:t.React.createElement(f.Icon,{source:l.getAssetIDByName("ic_locale_24px")}),trailing:function(){return t.React.createElement(f.Arrow,null)},onPress:function(){return r.push("VendettaCustomPage",{title:"Translator",render:ae})}}),t.React.createElement(re,{style:ie.subheaderText,onPress:function(){return t.url.openURL("https://github.com/Rico040/bunny-plugins")}},`Build: (${C.manifest.hash.substring(0,7)})`))}const i=C.storage;i.target_lang??="EN",i.translator??=0;let j=[];var le={onLoad:function(){return j=[J(),Q()]},onUnload:function(){for(const e of j)e()},settings:se};return p.default=le,p.settings=i,Object.defineProperty(p,"__esModule",{value:!0}),p})({},vendetta.plugin,vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.ui,vendetta.ui.assets,vendetta.ui.components,vendetta.utils,vendetta,vendetta.commands,vendetta.ui.alerts,vendetta.storage,vendetta.ui.toasts);
